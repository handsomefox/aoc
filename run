#!/usr/bin/env bash
set -euo pipefail
if [[ $# -lt 1 ]]; then
  echo "usage: run <year/day> [--sample] [extra go flags]" >&2
  exit 1
fi
spec=$1
shift || true

year=${spec%%/*}
day=${spec##*/}

if [[ $day == 0* ]]; then
  day=${day#0}
fi

dir="./${year}/${day}"
if [[ ! -d $dir ]]; then
  echo "missing day folder: ${dir}" >&2
  exit 1
fi
if [[ ! -f $dir/main.go ]]; then
  echo "missing main.go in ${dir}" >&2
  exit 1
fi

go run "$dir" "$@"
